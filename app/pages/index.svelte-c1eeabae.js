import{S as le,i as se,s as oe,e as E,c as M,a as T,d as g,b as S,f as A,t as k,g as w,I as v,h as z,K as ae,L as V,M as N,j,k as F,N as ne,l as B,p as q,n as G,o as re,O as ie,J as ce,P as ue,Q as W,m as fe,R,T as de,U as X}from"../chunks/vendor-ca6136d6.js";function Y(r,e,t){const l=r.slice();return l[11]=e[t],l[13]=t,l}function Z(r){let e;function t(a,n){return a[2]?he:pe}let l=t(r),o=l(r);return{c(){e=E("span"),o.c(),this.h()},l(a){e=M(a,"SPAN",{class:!0});var n=T(e);o.l(n),n.forEach(g),this.h()},h(){S(e,"class","text-3xl text-center font-tw drop-shadow mb-2 svelte-efzwv")},m(a,n){A(a,e,n),o.m(e,null)},p(a,n){l===(l=t(a))&&o?o.p(a,n):(o.d(1),o=l(a),o&&(o.c(),o.m(e,null)))},d(a){a&&g(e),o.d()}}}function pe(r){let e;return{c(){e=k("getting your musicolors <3")},l(t){e=w(t,"getting your musicolors <3")},m(t,l){A(t,e,l)},p:ce,d(t){t&&g(e)}}}function he(r){let e,t,l,o,a=r[2].color+"",n,i,m;return{c(){e=k("your musicolor is "),t=E("span"),l=E("span"),o=k("copied!"),n=k(a),this.h()},l(d){e=w(d,"your musicolor is "),t=M(d,"SPAN",{class:!0,style:!0});var u=T(t);l=M(u,"SPAN",{class:!0});var b=T(l);o=w(b,"copied!"),b.forEach(g),n=w(u,a),u.forEach(g),this.h()},h(){S(l,"class","transition-opacity ease-in-out duration-500 invisible text-sm rounded font-normal absolute p-1 bg-white text-black"),S(t,"class","font-bold relaive group cursor-pointer"),N(t,"color",r[2].color),N(t,"-webkit-tap-highlight-color","transparent")},m(d,u){A(d,e,u),A(d,t,u),v(t,l),v(l,o),r[7](l),v(t,n),i||(m=ue(t,"click",r[6]),i=!0)},p(d,u){u&4&&a!==(a=d[2].color+"")&&z(n,a),u&4&&N(t,"color",d[2].color)},d(d){d&&g(e),d&&g(t),r[7](null),i=!1,m()}}}function $(r){let e,t=r[11]+"",l,o,a,n;return{c(){e=E("span"),l=k(t),this.h()},l(i){e=M(i,"SPAN",{class:!0});var m=T(e);l=w(m,t),m.forEach(g),this.h()},h(){S(e,"class",o="text-2xl w-full opacity-20 text-white block "+(r[13]%2==0?"text-left":"text-right"))},m(i,m){A(i,e,m),v(e,l),n=!0},p(i,m){(!n||m&16)&&t!==(t=i[11]+"")&&z(l,t)},i(i){n||(ae(()=>{a||(a=V(e,W,{},!0)),a.run(1)}),n=!0)},o(i){a||(a=V(e,W,{},!1)),a.run(0),n=!1},d(i){i&&g(e),i&&a&&a.end()}}}function x(r){let e,t,l,o,a;return{c(){e=E("a"),t=k("log in with "),l=E("span"),o=k("spotify"),a=k(` to see
      your musicolors :)`),this.h()},l(n){e=M(n,"A",{href:!0,target:!0,class:!0,style:!0});var i=T(e);t=w(i,"log in with "),l=M(i,"SPAN",{class:!0});var m=T(l);o=w(m,"spotify"),m.forEach(g),a=w(i,` to see
      your musicolors :)`),i.forEach(g),this.h()},h(){S(l,"class","text-green-600 font-bold"),S(e,"href",r[5]),S(e,"target","_blank"),S(e,"class","cursor-pointer text-xl text-center font-tw group svelte-efzwv"),N(e,"width","33vh")},m(n,i){A(n,e,i),v(e,t),v(e,l),v(l,o),v(e,a)},p(n,i){i&32&&S(e,"href",n[5])},d(n){n&&g(e)}}}function ee(r){let e,t,l=r[3].energetic+"",o,a,n=r[3].instrumental+"",i,m,d=r[3].happiness+"",u,b;return{c(){e=E("span"),t=k("your style is "),o=k(l),a=k(", "),i=k(n),m=k(" and "),u=k(d),b=k(" :)"),this.h()},l(c){e=M(c,"SPAN",{class:!0});var y=T(e);t=w(y,"your style is "),o=w(y,l),a=w(y,", "),i=w(y,n),m=w(y," and "),u=w(y,d),b=w(y," :)"),y.forEach(g),this.h()},h(){S(e,"class","absolute bottom-5 w-full text-center")},m(c,y){A(c,e,y),v(e,t),v(e,o),v(e,a),v(e,i),v(e,m),v(e,u),v(e,b)},p(c,y){y&8&&l!==(l=c[3].energetic+"")&&z(o,l),y&8&&n!==(n=c[3].instrumental+"")&&z(i,n),y&8&&d!==(d=c[3].happiness+"")&&z(u,d)},d(c){c&&g(e)}}}function me(r){let e,t,l,o,a,n,i,m,d,u=r[0]&&Z(r),b=r[4],c=[];for(let s=0;s<b.length;s+=1)c[s]=$(Y(r,b,s));const y=s=>G(c[s],1,1,()=>{c[s]=null});let f=!r[0]&&x(r),_=r[3]&&ee(r);return{c(){e=j(),t=E("main"),u&&u.c(),l=j(),o=E("div");for(let s=0;s<c.length;s+=1)c[s].c();n=j(),f&&f.c(),i=j(),_&&_.c(),m=F(),this.h()},l(s){ne('[data-svelte="svelte-7uar8o"]',document.head).forEach(g),e=B(s),t=M(s,"MAIN",{class:!0});var p=T(t);u&&u.l(p),l=B(p),o=M(p,"DIV",{class:!0,style:!0});var C=T(o);for(let L=0;L<c.length;L+=1)c[L].l(C);C.forEach(g),n=B(p),f&&f.l(p),p.forEach(g),i=B(s),_&&_.l(s),m=F(),this.h()},h(){document.title="musicolor",S(o,"class",a="overflow-hidden font-tw p-5 rounded-lg shadow-lg aspect-square"+(r[0]?"":" frame")+" svelte-efzwv"),N(o,"width","33vh"),N(o,"background",r[2]?`linear-gradient(238deg, ${r[2].color}, ${r[2].gradient})`:"linear-gradient(238deg, #9700fd, #003dfd)"),S(t,"class","w-full h-full flex flex-col justify-center items-center")},m(s,h){A(s,e,h),A(s,t,h),u&&u.m(t,null),v(t,l),v(t,o);for(let p=0;p<c.length;p+=1)c[p].m(o,null);v(t,n),f&&f.m(t,null),A(s,i,h),_&&_.m(s,h),A(s,m,h),d=!0},p(s,[h]){if(s[0]?u?u.p(s,h):(u=Z(s),u.c(),u.m(t,l)):u&&(u.d(1),u=null),h&16){b=s[4];let p;for(p=0;p<b.length;p+=1){const C=Y(s,b,p);c[p]?(c[p].p(C,h),q(c[p],1)):(c[p]=$(C),c[p].c(),q(c[p],1),c[p].m(o,null))}for(fe(),p=b.length;p<c.length;p+=1)y(p);re()}(!d||h&1&&a!==(a="overflow-hidden font-tw p-5 rounded-lg shadow-lg aspect-square"+(s[0]?"":" frame")+" svelte-efzwv"))&&S(o,"class",a),(!d||h&4)&&N(o,"background",s[2]?`linear-gradient(238deg, ${s[2].color}, ${s[2].gradient})`:"linear-gradient(238deg, #9700fd, #003dfd)"),s[0]?f&&(f.d(1),f=null):f?f.p(s,h):(f=x(s),f.c(),f.m(t,null)),s[3]?_?_.p(s,h):(_=ee(s),_.c(),_.m(m.parentNode,m)):_&&(_.d(1),_=null)},i(s){if(!d){for(let h=0;h<b.length;h+=1)q(c[h]);d=!0}},o(s){c=c.filter(Boolean);for(let h=0;h<c.length;h+=1)G(c[h]);d=!1},d(s){s&&g(e),s&&g(t),u&&u.d(),ie(c,s),f&&f.d(),s&&g(i),_&&_.d(s),s&&g(m)}}}function te(r,e,t){t/=100;const l=e*Math.min(t,1-t)/100,o=a=>{const n=(a+r/30)%12,i=t-l*Math.max(Math.min(n-3,9-n,1),-1);return Math.round(255*i).toString(16).padStart(2,"0")};return`#${o(0)}${o(8)}${o(4)}`}function _e(r,e,t){let l,o,a,n=new Array,i=!1,m,d="https://accounts.spotify.com/authorize";d+="?response_type=token",d+="&client_id="+encodeURIComponent("e069de3022af4a738e103dfa452c80a2"),d+="&scope=user-top-read",d+="&redirect_uri="+encodeURIComponent("https://euromoon.github.io/musicolor/callback");function u(){let f=localStorage.getItem("token"),_=localStorage.getItem("expireTime");f&&_&&(console.log(Date.now(),parseInt(R.Buffer.from(_,"base64").toString())),Date.now()>parseInt(R.Buffer.from(_,"base64").toString())?localStorage.clear():(m=R.Buffer.from(f,"base64").toString(),t(0,i=!0)))}async function b(){return new Promise(f=>{X.get("https://api.spotify.com/v1/me/top/tracks?limit=15&time_range=short_term",{headers:{Authorization:"Bearer "+m,"Content-Type":"application/json"}}).then(_=>{t(4,n=_.data.items.slice(0,10).map(h=>h.name.toLowerCase()));let s=_.data.items.map(h=>h.id);X.get(`https://api.spotify.com/v1/audio-features?ids=${s.join(",")}`,{headers:{Authorization:"Bearer "+m,"Content-Type":"application/json"}}).then(h=>{let p=h.data.audio_features,C=p.map(I=>1-I.valence),L=C.reduce((I,P)=>I+P,0)/C.length,D=p.map(I=>I.energy),O=D.reduce((I,P)=>I+P,0)/D.length,H=p.map(I=>(I.loudness+60)/60),U=H.reduce((I,P)=>I+P,0)/H.length;console.log(U);let J=Math.round(O*360),K=Math.round(U*100),Q=Math.round((1-L)*100);t(3,a={instrumental:U>=.5?"loud":"quiet",energetic:L<=.5?"happy":"melancholic",happiness:O>=.5?"energetic":"chill"}),f({color:te(J,K,Q),gradient:te(J,K,Q*.6)})})})})}function c(){l.classList.remove("invisible"),navigator.clipboard.writeText(o.color),t(1,l.style.opacity="0%",l);let f={x:Math.random()*100,y:(Math.random()*1.5-1)*100},_=.1;t(1,l.style.transform=`translate(${f.x}%, ${f.y}%)`,l);let s=setInterval(()=>{f.y+=_,_+=.1,t(1,l.style.transform=`translate(${f.x}%, ${f.y}%)`,l)},10);setTimeout(()=>{l.classList.add("invisible"),t(1,l.style.opacity="100%",l),clearInterval(s)},500)}u(),window.addEventListener("storage",u);function y(f){de[f?"unshift":"push"](()=>{l=f,t(1,l)})}return r.$$.update=()=>{r.$$.dirty&1&&i&&b().then(f=>{t(2,o=f)})},[i,l,o,a,n,d,c,y]}class ye extends le{constructor(e){super();se(this,e,_e,me,oe,{})}}export{ye as default};
