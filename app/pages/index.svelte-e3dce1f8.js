import{S as G,i as H,s as ee,K as $,L as W,a as x,d as p,b as g,M as fe,f as C,I as m,J as F,e as P,t as S,j as M,c as z,g as I,l as T,N as J,O as de,h as U,P as pe,Q as te,v as he,k as le,R as _e,w as me,T as j,x as ge,p as K,n as Q,o as ve,A as ye,U as be,V as we,W as se,m as ke,X as ae,Y as X,Z as oe}from"../chunks/vendor-d4f690f0.js";function Ee(n){let e,t,a,l;return{c(){e=$("svg"),t=$("symbol"),a=$("path"),l=$("use"),this.h()},l(o){e=W(o,"svg",{class:!0});var s=x(e);t=W(s,"symbol",{id:!0,viewBox:!0});var i=x(t);a=W(i,"path",{d:!0}),x(a).forEach(p),i.forEach(p),l=W(s,"use",{"xlink:href":!0}),x(l).forEach(p),s.forEach(p),this.h()},h(){g(a,"d","M28 16h-5l-7 7-7-7h-5l-4 8v2h32v-2l-4-8zM0 28h32v2h-32v-2zM18 10v-8h-4v8h-7l9 9 9-9h-7z"),g(t,"id","icon-download"),g(t,"viewBox","0 0 32 32"),fe(l,"xlink:href","#icon-download"),g(e,"class","icon icon-download text-2xl svelte-10r85o2")},m(o,s){C(o,e,s),m(e,t),m(t,a),m(e,l)},p:F,i:F,o:F,d(o){o&&p(e)}}}class Ae extends G{constructor(e){super();H(this,e,null,Ee,ee,{})}}const{document:re}=we;function ne(n,e,t){const a=n.slice();return a[13]=e[t],a[15]=t,a}function ie(n){let e,t,a,l,o,s,i,h,f,c,E,b,u,B;return{c(){e=P("div"),t=P("span"),a=S("last month"),o=M(),s=P("span"),i=S("last 6 months"),f=M(),c=P("span"),E=S("all time"),this.h()},l(d){e=z(d,"DIV",{class:!0});var v=x(e);t=z(v,"SPAN",{"data-range":!0,class:!0});var N=x(t);a=I(N,"last month"),N.forEach(p),o=T(v),s=z(v,"SPAN",{"data-range":!0,class:!0});var A=x(s);i=I(A,"last 6 months"),A.forEach(p),f=T(v),c=z(v,"SPAN",{"data-range":!0,class:!0});var k=x(c);E=I(k,"all time"),k.forEach(p),v.forEach(p),this.h()},h(){g(t,"data-range","0"),g(t,"class",l="transition-colors py-1 px-3"+(n[1]==0?" bg-white text-slate-900":"")+" rounded-l cursor-pointer"),g(s,"data-range","1"),g(s,"class",h="transition-colors py-1 px-3"+(n[1]==1?" bg-white text-slate-900":"")+" cursor-pointer"),g(c,"data-range","2"),g(c,"class",b="transition-colors py-1 px-3"+(n[1]==2?" bg-white text-slate-900":"")+" rounded-r cursor-pointer"),g(e,"class","absolute top-5")},m(d,v){C(d,e,v),m(e,t),m(t,a),m(e,o),m(e,s),m(s,i),m(e,f),m(e,c),m(c,E),u||(B=[J(t,"click",n[8]),J(s,"click",n[8]),J(c,"click",n[8])],u=!0)},p(d,v){v&2&&l!==(l="transition-colors py-1 px-3"+(d[1]==0?" bg-white text-slate-900":"")+" rounded-l cursor-pointer")&&g(t,"class",l),v&2&&h!==(h="transition-colors py-1 px-3"+(d[1]==1?" bg-white text-slate-900":"")+" cursor-pointer")&&g(s,"class",h),v&2&&b!==(b="transition-colors py-1 px-3"+(d[1]==2?" bg-white text-slate-900":"")+" rounded-r cursor-pointer")&&g(c,"class",b)},d(d){d&&p(e),u=!1,de(B)}}}function ce(n){let e,t=n[13]+"",a,l,o,s;return{c(){e=P("span"),a=S(t),this.h()},l(i){e=z(i,"SPAN",{class:!0});var h=x(e);a=I(h,t),h.forEach(p),this.h()},h(){g(e,"class",l="text-2xl w-full opacity-20 text-white block "+(n[15]%2==0?"text-left":"text-right"))},m(i,h){C(i,e,h),m(e,a),s=!0},p(i,h){(!s||h&16)&&t!==(t=i[13]+"")&&U(a,t)},i(i){s||(pe(()=>{o||(o=te(e,se,{},!0)),o.run(1)}),s=!0)},o(i){o||(o=te(e,se,{},!1)),o.run(0),s=!1},d(i){i&&p(e),i&&o&&o.end()}}}function Se(n){let e,t,a,l,o;return{c(){e=P("a"),t=S("log in with "),a=P("span"),l=S("spotify"),o=S(` to see
      your musicolors :)`),this.h()},l(s){e=z(s,"A",{href:!0,target:!0,class:!0,style:!0});var i=x(e);t=I(i,"log in with "),a=z(i,"SPAN",{class:!0});var h=x(a);l=I(h,"spotify"),h.forEach(p),o=I(i,` to see
      your musicolors :)`),i.forEach(p),this.h()},h(){g(a,"class","text-green-600 font-bold"),g(e,"href",n[6]),g(e,"target","_blank"),g(e,"class","cursor-pointer text-xl text-center font-tw group"),j(e,"width","33vh")},m(s,i){C(s,e,i),m(e,t),m(e,a),m(a,l),m(e,o)},p(s,i){i&64&&g(e,"href",s[6])},d(s){s&&p(e)}}}function Ie(n){let e;function t(o,s){return o[2]?Ce:xe}let a=t(n),l=a(n);return{c(){e=P("span"),l.c(),this.h()},l(o){e=z(o,"SPAN",{class:!0,style:!0});var s=x(e);l.l(s),s.forEach(p),this.h()},h(){g(e,"class","text-3xl text-center font-tw drop-shadow mb-2"),j(e,"width","33vh")},m(o,s){C(o,e,s),l.m(e,null)},p(o,s){a===(a=t(o))&&l?l.p(o,s):(l.d(1),l=a(o),l&&(l.c(),l.m(e,null)))},d(o){o&&p(e),l.d()}}}function xe(n){let e;return{c(){e=S("getting your musicolors <3")},l(t){e=I(t,"getting your musicolors <3")},m(t,a){C(t,e,a)},p:F,d(t){t&&p(e)}}}function Ce(n){let e,t,a,l,o=n[2].color+"",s,i,h;return{c(){e=S("the color of "),t=S(n[5]),a=S(" music is "),l=P("span"),s=S(o),this.h()},l(f){e=I(f,"the color of "),t=I(f,n[5]),a=I(f," music is "),l=z(f,"SPAN",{class:!0,style:!0});var c=x(l);s=I(c,o),c.forEach(p),this.h()},h(){g(l,"class","font-bold relaive group cursor-pointer"),j(l,"color",n[2].color)},m(f,c){C(f,e,c),C(f,t,c),C(f,a,c),C(f,l,c),m(l,s),i||(h=J(l,"click",n[7]),i=!0)},p(f,c){c&32&&U(t,f[5]),c&4&&o!==(o=f[2].color+"")&&U(s,o),c&4&&j(l,"color",f[2].color)},d(f){f&&p(e),f&&p(t),f&&p(a),f&&p(l),i=!1,h()}}}function ue(n){let e,t,a=n[3].energetic+"",l,o,s=n[3].loudness+"",i,h,f=n[3].happiness+"",c,E;return{c(){e=P("span"),t=S("your style is "),l=S(a),o=S(", "),i=S(s),h=S(" and "),c=S(f),E=S(" :)"),this.h()},l(b){e=z(b,"SPAN",{class:!0});var u=x(e);t=I(u,"your style is "),l=I(u,a),o=I(u,", "),i=I(u,s),h=I(u," and "),c=I(u,f),E=I(u," :)"),u.forEach(p),this.h()},h(){g(e,"class","absolute bottom-5 w-full text-center")},m(b,u){C(b,e,u),m(e,t),m(e,l),m(e,o),m(e,i),m(e,h),m(e,c),m(e,E)},p(b,u){u&8&&a!==(a=b[3].energetic+"")&&U(l,a),u&8&&s!==(s=b[3].loudness+"")&&U(i,s),u&8&&f!==(f=b[3].happiness+"")&&U(c,f)},d(b){b&&p(e)}}}function Ne(n){let e,t,a,l,o,s,i,h,f,c,E,b,u=n[2]&&ie(n);s=new Ae({});let B=n[4],d=[];for(let r=0;r<B.length;r+=1)d[r]=ce(ne(n,B,r));const v=r=>Q(d[r],1,1,()=>{d[r]=null});function N(r,y){return r[0]?Ie:Se}let A=N(n),k=A(n),w=n[3]&&ue(n);return{c(){e=M(),t=P("main"),u&&u.c(),a=M(),l=P("div"),o=P("div"),he(s.$$.fragment),i=M();for(let r=0;r<d.length;r+=1)d[r].c();f=M(),k.c(),c=M(),w&&w.c(),E=le(),this.h()},l(r){_e('[data-svelte="svelte-7uar8o"]',re.head).forEach(p),e=T(r),t=z(r,"MAIN",{class:!0});var _=x(t);u&&u.l(_),a=T(_),l=z(_,"DIV",{class:!0,style:!0});var L=x(l);o=z(L,"DIV",{class:!0});var q=x(o);me(s.$$.fragment,q),q.forEach(p),i=T(L);for(let R=0;R<d.length;R+=1)d[R].l(L);L.forEach(p),f=T(_),k.l(_),_.forEach(p),c=T(r),w&&w.l(r),E=le(),this.h()},h(){re.title="musicolor",g(o,"class","absolute top-2 right-2 cursor-pointer transition-opacity opacity-0 group-hover:opacity-100"),g(l,"class",h="group relative mb-5 overflow-hidden font-tw p-5 rounded-lg shadow-lg aspect-square"+(n[0]?"":" frame")+" svelte-q6zdfp"),j(l,"width","33vh"),j(l,"background",n[2]?`linear-gradient(238deg, ${n[2].color}, ${n[2].gradient})`:"linear-gradient(238deg, #9700fd, #003dfd)"),g(t,"class","w-full h-full flex flex-col justify-center items-center font-ttw")},m(r,y){C(r,e,y),C(r,t,y),u&&u.m(t,null),m(t,a),m(t,l),m(l,o),ge(s,o,null),m(l,i);for(let _=0;_<d.length;_+=1)d[_].m(l,null);m(t,f),k.m(t,null),C(r,c,y),w&&w.m(r,y),C(r,E,y),b=!0},p(r,[y]){if(r[2]?u?u.p(r,y):(u=ie(r),u.c(),u.m(t,a)):u&&(u.d(1),u=null),y&16){B=r[4];let _;for(_=0;_<B.length;_+=1){const L=ne(r,B,_);d[_]?(d[_].p(L,y),K(d[_],1)):(d[_]=ce(L),d[_].c(),K(d[_],1),d[_].m(l,null))}for(ke(),_=B.length;_<d.length;_+=1)v(_);ve()}(!b||y&1&&h!==(h="group relative mb-5 overflow-hidden font-tw p-5 rounded-lg shadow-lg aspect-square"+(r[0]?"":" frame")+" svelte-q6zdfp"))&&g(l,"class",h),(!b||y&4)&&j(l,"background",r[2]?`linear-gradient(238deg, ${r[2].color}, ${r[2].gradient})`:"linear-gradient(238deg, #9700fd, #003dfd)"),A===(A=N(r))&&k?k.p(r,y):(k.d(1),k=A(r),k&&(k.c(),k.m(t,null))),r[3]?w?w.p(r,y):(w=ue(r),w.c(),w.m(E.parentNode,E)):w&&(w.d(1),w=null)},i(r){if(!b){K(s.$$.fragment,r);for(let y=0;y<B.length;y+=1)K(d[y]);b=!0}},o(r){Q(s.$$.fragment,r),d=d.filter(Boolean);for(let y=0;y<d.length;y+=1)Q(d[y]);b=!1},d(r){r&&p(e),r&&p(t),u&&u.d(),ye(s),be(d,r),k.d(),r&&p(c),w&&w.d(r),r&&p(E)}}}function Pe(n){return["short_term","medium_term","long_term"][n]}function ze(n,e,t){let a=new Array,l,o,s=new Array,i,h,f=!1,c=2,E="https://accounts.spotify.com/authorize";E+="?response_type=token",E+="&client_id="+encodeURIComponent("e069de3022af4a738e103dfa452c80a2"),E+="&scope=user-top-read",E+="&redirect_uri="+encodeURIComponent("https://eurmn.github.io/musicolor/callback");function b(){let v=localStorage.getItem("token"),N=localStorage.getItem("expireTime");v&&N&&(Date.now()>parseInt(ae.Buffer.from(N,"base64").toString())?localStorage.clear():(i=ae.Buffer.from(v,"base64").toString(),t(0,f=!0)))}async function u(v){return new Promise(N=>{h||X.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer "+i,"Content-Type":"application/json"}}).then(A=>{t(5,h=(A.data.display_name||A.data.id)+"'"),h.endsWith("s")||t(5,h+="s")}),X.get(`https://api.spotify.com/v1/me/top/tracks?limit=15&time_range=${Pe(v)}`,{headers:{Authorization:"Bearer "+i,"Content-Type":"application/json"}}).then(A=>{t(4,s=A.data.items.slice(0,10).map(w=>w.name.toLowerCase()));let k=A.data.items.map(w=>w.id);X.get(`https://api.spotify.com/v1/audio-features?ids=${k.join(",")}`,{headers:{Authorization:"Bearer "+i,"Content-Type":"application/json"}}).then(w=>{let r=w.data.audio_features,y=r.map(D=>D.energy),_=y.reduce((D,V)=>D+V,0)/y.length,L=r.map(D=>(D.loudness+60)/60),q=L.reduce((D,V)=>D+V,0)/L.length,R=r.map(D=>1-D.valence),O=R.reduce((D,V)=>D+V,0)/R.length,Y=Math.round((1-_)*360),Z={color:oe.hsl(Y,q,O).hex(),gradient:oe.hsl(Y,q,O*.6).hex()};t(3,o={loudness:q>=.5?"loud":"quiet",energetic:O<=.5?"happy":"melancholic",happiness:_>=.5?"energetic":"chill"}),t(9,a[v]={colorData:Z,songs:s,musicStyle:o},a),N(Z)})})})}function B(v){navigator.clipboard.writeText(l.color);let N=v.target,A=document.createElement("span"),k={x:Math.random()*100,y:(Math.random()*1.5-1)*100};A.classList.add("text-xl","rounded","absolute","p-1","text-white","left-1/2"),A.textContent="copied!",N.appendChild(A),A.animate([{opacity:1,transform:`translate(${k.x}%, ${k.y}%)`},{opacity:0,transform:`translate(${k.x}%, ${k.y+10}%)`}],{duration:500,easing:"ease-in-out"}).addEventListener("finish",()=>A.remove())}function d(v){let N=v.target;t(1,c=parseInt(N.getAttribute("data-range")))}return b(),window.addEventListener("storage",b),n.$$.update=()=>{n.$$.dirty&515&&f&&c!=null&&(a[c]!=null?(t(2,l=a[c].colorData),t(4,s=a[c].songs),t(3,o=a[c].musicStyle)):u(c).then(v=>{t(2,l=v)}))},[f,c,l,o,s,h,E,B,d,a]}class De extends G{constructor(e){super();H(this,e,ze,Ne,ee,{})}}export{De as default};
